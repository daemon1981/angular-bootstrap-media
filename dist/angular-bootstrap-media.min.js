/*! angular-bootstrap-media - v0.0.10 - 2014-04-08
 * Copyright (c) 2014 Damien Saillard <dam.saillard@gmail.com> (http://damien-saillard.fr/);
 * Licensed 
 */
angular.module("angular.bootstrap.media",["angular.bootstrap.media.templates","angular.simple.gravatar","ngSanitize"]).controller("MediaController",["$scope",function(a){var b=function(b){a.media=b},c=function(){console.log("error")};a.focusMediaCommentArea=function(a){$(a.currentTarget).closest(".media-body").find(".form-control").focus()},a.userInArray=function(b){return-1!==b.indexOf(a.currentUser._id)},a.like=function(){a.media.$addLike(b,c)},a.unlike=function(){a.media.$removeLike(b,c)},a.ownMedia=function(){return a.media.creator._id===a.currentUser._id},a.comment=function(){a.message&&a.media.$addComment(a.message,function(c){a.message="",b(c)},c)},a.removeComment=function(d){a.media.$removeComment(d._id,b,c)},a.displayPreviousComments=function(){a.media.$getPreviousComments(a.media.comments.length,10,function(b){for(var c=Object.keys(b).length-1;c>=0;c--)a.media.comments.unshift(b[c])},c)}}]).directive("media",function(){return{restrict:"E",replace:!0,scope:{currentUser:"=",media:"=",maxLastComments:"=",deleteLabel:"@",defaultGravatarImage:"@",editMedia:"&onMediaEdit",removeMedia:"&onMediaRemove"},templateUrl:"media.tpl.html",controller:"MediaController"}}).controller("CommentController",["$scope",function(a){var b=function(b){return function(){a.media.$getComment(b,function(b){a.comment=b},function(a){console.log(a)})}},c=function(){console.log("error")};a.userInArray=function(b){return b?-1!==b.indexOf(a.currentUser._id):void 0},a.likeComment=function(){a.media.$addLikeToComment(a.comment._id,b(a.comment._id),c)},a.unlikeComment=function(){a.media.$removeLikeFromComment(a.comment._id,b(a.comment._id),c)},a.ownComment=function(){return a.comment.creator._id===a.currentUser._id}}]).directive("comment",function(){return{restrict:"E",replace:!0,scope:{currentUser:"=",media:"=",comment:"=",defaultGravatarImage:"@",removeComment:"&onCommentRemove"},templateUrl:"comment.tpl.html",controller:"CommentController"}}),angular.module("angular.bootstrap.media.templates",["comment.tpl.html","media.tpl.html"]),angular.module("comment.tpl.html",[]).run(["$templateCache",function(a){a.put("comment.tpl.html",'<div class="media comment">    <a class="pull-left" href="#">        <gravatar email="comment.creator.email" size="30" class="img-polaroid pull-right" default-image="defaultGravatarImage"></gravatar>    </a>    <div class="media-body">        {{comment.message}}        <div>            <span class="badge ng-binding comment-num-likes">{{comment.likes.length}} <span class="glyphicon glyphicon-thumbs-up"></span></span>            <button type="button" class="btn btn-link" ng-show="!userInArray(comment.likes)" ng-click="likeComment()">Like</button>            <button type="button" class="btn btn-link" ng-show="userInArray(comment.likes)" ng-click="unlikeComment()">Unlike</button>            <button type="button" class="btn btn-danger btn-xs" ng-show="ownComment()" ng-click="removeComment(comment)">                <span class="glyphicon glyphicon-remove"></span>            </button>        </div>    </div></div>')}]),angular.module("media.tpl.html",[]).run(["$templateCache",function(a){a.put("media.tpl.html",'<div class="media">    <a class="pull-left" href="#">        <gravatar email="media.creator.email" size="30" class="img-polaroid pull-right" default-image="defaultGravatarImage"></gravatar>    </a>    <div class="media-body">        <div ng-bind-html="media.text"></div>        <div>            <button type="button" class="btn btn-danger btn-xs" ng-show="ownMedia()" ng-click="removeMedia(media)">{{deleteLabel}}</button>            &nbsp;&nbsp;            <span class="badge ng-binding media-num-likes">{{media.likes.length}} <span class="glyphicon glyphicon-thumbs-up"></span></span>            <button type="button" class="btn btn-link" ng-show="!userInArray(media.likes)" ng-click="like()">Like</button>            <button type="button" class="btn btn-link" ng-show="userInArray(media.likes)" ng-click="unlike()">Unlike</button>            <button type="button" class="btn btn-link" ng-click="focusMediaCommentArea($event)">Comment</button>            <button type="button" class="btn btn-default btn-xs" ng-show="ownMedia()" ng-click="editMedia(media)">                <span class="glyphicon glyphicon-pencil"></span>            </button>        </div>        <div>            <button type="button" class="btn btn-link" ng-click="displayPreviousComments()">Voir les commentaires précédents</button>        </div>        <comment class="comment" comment="comment" media="media" current-user="currentUser" ng-repeat="comment in media.comments" on-comment-remove="removeComment(comment)" default-gravatar-image="{{defaultGravatarImage}}"></comment>        <div class="media comment-editor">            <a class="pull-left" href="#">                <gravatar email="currentUser.email" size="30" class="img-polaroid pull-right" default-image="defaultGravatarImage"></gravatar>            </a>            <div class="media-body">                <form ng-submit="comment()">                    <div class="input-group col-lg-6">                        <input class="form-control" type="text" name="message" ng-model="message">                        <span class="input-group-btn">                            <input type="submit" class="btn btn-primary" value="Commenter">                        </span>                    </div>                </form>            </div>        </div>    </div></div>')}]);